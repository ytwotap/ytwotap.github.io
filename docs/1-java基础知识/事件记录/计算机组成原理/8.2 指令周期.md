

# cpu结构和功能

[TOC]

## 指令周期

### 基本概念

CPU 每取出并执行一条指令所需的全部时间称为指令周期

CPU 完成一条指令的时间



图中的取指阶段完成取指令和分析指令的操作，又称取指周期3 执行阶段完
成执行指令的操作，又称执行周期

![image-20200522184057798](D:\src\Typora记录\计算机组成原理\images\image-20200522184057798.png)

###### 各种周期比较

![image-20200522184117368](D:\src\Typora记录\计算机组成原理\images\image-20200522184117368.png)

说明:上图说明不同指令的周期不同



**当遇到间接寻址的指令时**

![image-20200522184248937](D:\src\Typora记录\计算机组成原理\images\image-20200522184248937.png)



#### **指令周期流程**

，一个完整的指令周期应包括取指、间址、执行和中断4 个子周期，如图8.8 所示。由于闵址
周期和中断周期不一定包含在每个指令周期内，故图中用菱形框判断。

![image-20200522184554255](D:\src\Typora记录\计算机组成原理\images\image-20200522184554255.png)

上述4 个周期都有CPU 访存操作，只是访存的目的不同。取指周期是为了取指令，间
址周期是为了取有效地址，执行周期是为了取操作数〈当指令为访存指令时），中断周期是为了
保存程序断点。这4 个周期又可称为CPU 的工作用期，为了区别它们，在CPU 内可设置4 个标
志触发器



![image-20200522184650804](D:\src\Typora记录\计算机组成原理\images\image-20200522184650804.png)

图8.9 所示的FE 、IND,EX 和INT 分别对应取指、问址、执行和中断4 个周期，并以“ 1 ”状态
表示有效，它们分别由1 →陀、1→IND 、1→EX 和1→INT 这4 个信号控制。



### 指令周期的数据流

为了便于分析指令周期中的数据流，假设CPU 中有存储器地址寄存器MAR 、存储器数据寄
存器MDR ，.程序计数器PC 和指令寄存器IRo

#### 1.取指周期的数据流

![image-20200522185920429](D:\src\Typora记录\计算机组成原理\images\image-20200522185920429.png)

图8. 10 所示的是取指周期的数据流。PC 中存放现行指令的地址，该地址送到MAR 并送至
地址总线．，然后由控制部件cu 向存储器发读命令，使对应MAR 所指单元的内容（指令）经数据
总线送至.MOR ，再送至IR ，并且cu 控制PC 内容加1 ，形成下一条指令的地址。



#### 间址周期的数据流

![image-20200522190020758](D:\src\Typora记录\计算机组成原理\images\image-20200522190020758.png)

一旦取指周期结束， cu 便检查IR 中的内容，以确定其是否有间址操作，如果需要问址操作，则MDR 中指示形式地址的右N 位（记作Ad(MDR ））将被
送到MAR ，又送至地址总线，此后cu 向存储器发读命令，以获取有效地址并存至MDRo



#### 执行周期的数据流

由于不同的指令在执行周期的操作不同，因此执行周期的数据流是多种多样的，可能涉及
CPU 内部寄z存器间的数据传送、对存储器（或1/0 ）进行读写操作或对ALU 的操作，困此，无法用
统一的数据流图表示。



#### 中断周期的数据流

![image-20200522190115603](D:\src\Typora记录\计算机组成原理\images\image-20200522190115603.png)

图中由cu 把用于保存程序断点的存储器特殊地址（如核指针的内容）送往MAR ，并送到地
址总线上，然后由cu 向存储器发写命令，并将}:lC 的内容（程序断点）送到MDR ，最络使程序断
点经数据总线存入存储器。此外， cu 还需将中断服务程序的入口地址送至PC ，为下一个指令周
期的取指周期做好准备。



## 指令流水

**为啥要有指令流水?**

**为了提高访存速度**，一方面要提高存储芯片的性能，另一方丽可以
从体系结构上，如采用多体、Cache 等分级存储措施来提高存储器的性能／价格比。为了提高主机与1/0 交换信息的速度，可以采用DMA 方式，也可以采用多总线结构，将速度不一的1/0 分别挂到尔同带宽的总线上，以解决总线的瓶颈问题。为了提高运算速度，可以采用高速芯片和快速进位链，以及改进算法等措施。为了进一步提商处理机速度，通常可从提高器件的性能和改进系统的结构，开发系统的并行性两方面入手。

(1 ）**提高器件的性能**

(2 ）**改进系统的结构，开发系统的并衍性**

所谓**并行，包含同时性和并发性两个方面。前者是指两个或多个事件在同一时刻发生，后者**
**是指两个或多个事件在同一时间段发生**。也就是说，在同一时刻或同一时间段内完成两种或两
种以上性质相同或不同的功能，只要在时间上互相重叠，就存在并行性。
并行性体现在不同等级上。

通常分为4 个级别：作业级或程序级、任务级或进程级、指令之
间级和指令内部级。前两级为粗粒度，又称为过程级；后两－级为细粒度，又称为指令级。粗粒度并行性（ Eoarse-grained "Parallelism ）一般用算法〈软件）实现，细粒度·并行性（ Fine-grained Parallelism）一般用硬件实现。从计算机体系上看，租粒度并行性是在多个处理机上分别运行多个进程，由多台处理机合作完成一个程序；**细粒度并行性是指在处理机的操作级和指令级的并行性，其中指令的流水作业就是一项意要技术。**这里只讨论有关指令流水的一些主要问题，其他有关粗粒度并行和粗粒度并行技术将在“计算机体系结构”课程中讲述。



### 原理

参考工厂装配线 不同位置不同操作 提高效率.


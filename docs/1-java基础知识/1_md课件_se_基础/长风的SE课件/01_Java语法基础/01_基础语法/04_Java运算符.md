# ④Java运算符（operator）

[TOC]

---



> 程序的世界里，数据无处不在，计算机的最基本用途之一就是执行数学运算
>
> Java作为一门程序设计语言，提供了丰富的运算符来操纵变量（从这个角度，运算符起着连接变量名字的作用）

- 运算符用于连接值（变量和常量）

> 运算符是一种特殊的符号，用以表示数据的运算，赋值和比较等
>
> 不同的运算符用来完成不同的运算，运算都有结果，所以表达式往往都有结果

- **表达式经过运算后都会产生一个确定的值（会有结果）（重要）**

> 和表达式对应的还有一个语句的概念

表达式（expression） vs  语句（statement） 

- 表达式一般都有确定的结果（值），不能构成一条能单独执行的代码（往往不能以分号结尾）
- 语句都是可以单独执行代码，以分号结尾，多数语句没有结果



> 运算符的分类：

- 一元运算符：只需要一个操作数参与运算，得到一个结果
- 二元运算符：需要两个操作数参与运算，得到一个结果
- 多元运算符：超过两个操作数参与运算，得到一个结果



---



## 1. 算术运算符（arithmetic）

> 算术运算符用在数学表达式中，它们的作用和在数学中的作用一样

- 自增、自减是典型的一元运算符

- 于是，对于int a = 10，int b =20，可得到以下表格

|          操作符           | 描述                                          | 例子        |
| :-----------------------: | :-------------------------------------------- | :---------- |
|             +             | 加法：相加运算符两侧的值，得到和              | a+b=30      |
|             -             | 减法：左操作数减去右操作数，得到差            | a-b=-10     |
|             *             | 乘法：相乘操作符两侧的值，得到积              | a*b=200     |
|             /             | 除法：左操作数除以右操作数，得到商            | a/b=0       |
|            ％             | 取余（取模）：左操作数除以右操作数，得到余数  | a%b=10      |
|            ++             | 自增：操作数的值增加1                         | a++一次是11 |
|            --             | 自减：操作数的值减少1                         | a--一次是9  |
| +（字符串运算、表示正数） | 无论什么数据类型和字符串用“+”相加，得到字符串 |             |



> 加减乘除取余注意事项

- 整型相加减乘除得不到小数



> 自增（++）/自减（--）是面试题目常客

- 自加自减，仅适用于变量，常量无法用自增自减运算符连接
- 当变量和自增自减符号，单独构成一个表达式语句，孤零零的放在那里
  - 其含义就是表示执行一次该操作数，加一或者减一
  - 自增、自减符号放在变量前面还是后面，无关紧要
- 变量和自增自减符号，单独构成一个表达式后又参与了运算或者输出语句
  - 自增自减符号和操作数的位置就至关重要了
  - 自增自减符号在变量前面，变量先自增自减，再参与后续运算或者赋值 
  - 自增自减符号在变量后面，变量先参与运算或者赋值，再自增自减



> 小试牛刀

第一题：求a，b，c的值

```java
int a = 10;
int b = 10;
int c = 10;
a = b++;
c = --a;
b = ++a;
a = c--;
```



第二题：求x，y值

```java
int x = 4;
int y = (x++) + (++x) + (x*10);
```

- 如果你不是为了出面试题，不要在开发中这样使用自增自减



---



## 2. 赋值运算符（assignment）

> 什么是赋值运算符？

- 赋值运算符用来为变量指定新值
- 赋值运算符是典型的二元运算符
- “==”不是赋值运算符

> 赋值运算符分为两类

- 基本的赋值运算符：“=”
- 扩展的赋值运算符（extension）： 如：“+=”、“-=”、"*="、“/=”等
- 无论是哪一种，赋值运算符总是把右边的操作数（计算后）赋值给左边
  - 所以，左边必须是一个变量来接收这个赋值
  - 当右边是字面值常量时，扩展赋值运算符是一种扩展的自增



对于两个操作数a，b

| 操作符 | 描述                                                         | 例子                     |
| :----- | :----------------------------------------------------------- | :----------------------- |
| + =    | 加和赋值操作符，它把左操作数和右操作数相加赋值给左操作数     | a + = b等价于a = a + b   |
| - =    | 减和赋值操作符，它把左操作数和右操作数相减赋值给左操作数     | a - =  b等价于a = a -  b |
| * =    | 乘和赋值操作符，它把左操作数和右操作数相乘赋值给左操作数     | a * = b等价于a = a * b   |
| / =    | 除和赋值操作符，它把左操作数和右操作数相除赋值给左操作数     | a / = b等价于a = a / b   |
| ％=    | 取模和赋值操作符，它把左操作数和右操作数取模后赋值给左操作数 | a％= b等价于a = a％b     |
| << =   | 左移位赋值运算符                                             | a << = 2等价于a = a << 2 |
| >> =   | 右移位赋值运算符                                             | b >> = 2等价于b = b >> 2 |
| ＆=    | 按位与赋值运算符                                             | a＆= 2等价于a = a＆2     |
| ^ =    | 按位异或赋值操作符                                           | a ^ = 2等价于a = a ^ 2   |
| \| =   | 按位或赋值操作符                                             | b \| = 2等价于b = b \| 2 |



> 小试牛刀
>
> 判断下列代码是否报错呢？

```java 
short s = 1;
s = s + 1;
```

```Java
short s1 = 1;
s1 += 1;
```



> 注意事项

- 对于扩展赋值运算符而言，如果右边运算式得到的结果和左边不同，则会自动发生强制类型转换

  - ```java
    int x = 0;
    x = x + 3.5;
    ```

  - ```java
    int x = 0;
    x += 3.5
    ```

  - 上述两个表达式，其含义是一样的，但只有第二个是合法的，说明扩展赋值运算符隐含强转

  - x += y   <---->  x = (x的数据类型) （x + y）
  
- 扩展赋值运算符的隐含强转，仍然会存在精度丢失

- **赋值运算符构成的赋值表达式，仍然有结果，其结果是赋值表达式右边要赋给左边变量的值**



---



## 3. 比较运算符（comparison）

> 什么是比较运算符

- 比较运算符用来判断两个变量或者常量的大小
- 比较运算符是典型的二元运算符
- 注意：比较运算符和操作数组成的表达式的结果是一个boolean值( true或者false)
  - 也叫**布尔表达式**

> 使用注意事项

- 基本数据类型和基本数据类型比，引用数据类型和引用数据类型比
- “==”和“!=”可以用于引用数据类型之间相比较，其余比较运算符则不行
- 对于数值类型基本数据类型而言，纯粹比较运算符两边的操作数的值
  - 和数据类型无关，也不会发生数据类型转换
  - 对于浮点数而言，精度问题尤其重要



对于操作数int a = 10，int b = 20

| 运算符 | 描述                                                         | 例子             |
| :----- | :----------------------------------------------------------- | :--------------- |
| ==     | 检查如果两个操作数的值是否相等，如果相等则条件为真。         | （a == b）为假。 |
| !=     | 检查如果两个操作数的值是否相等，如果值不相等则条件为真。     | (a != b) 为真。  |
| >      | 检查左操作数的值是否大于右操作数的值，如果是那么条件为真。   | （a  > b）为假。 |
| <      | 检查左操作数的值是否小于右操作数的值，如果是那么条件为真。   | （a <  b）为真。 |
| >=     | 检查左操作数的值是否大于或等于右操作数的值，如果是那么条件为真。 | （a >= b）为假。 |
| <=     | 检查左操作数的值是否小于或等于右操作数的值，如果是那么条件为真。 | （a <= b）为真。 |



---



## 4. 逻辑运算符（logical）

> 什么是逻辑运算符？

- 专门boolean类型进行计算的运算符，可以连接布尔表达式，也可以连接布尔变量、布尔常量
- 逻辑非运算符是典型的一元运算符，其余逻辑运算符都是二元运算符
- 逻辑运算表达式的结果也一定是boolean



对于 boolean a = true; boolean b = false

| 操作符 | 描述                                                         | 例子              |
| :----- | :----------------------------------------------------------- | :---------------- |
| &      | 称为逻辑与运算符。当且仅当两个操作数都为真，条件才为真。     | （a & b）为假     |
| \|     | 称为逻辑或运算符。如果任何两个操作数任何一个为真，条件为真。 | (a \| b)为真      |
| ^      | 成为逻辑异或运算符。相同时为false，不同时为true              | (a ^ b) 为真      |
| &&     | 称为短路与逻辑运算符。当且仅当两个操作数都为真，条件才为真。 | （A && B）为假    |
| \|\|   | 称为短路或逻辑运算符。如果任何两个操作数任何一个为真，条件为真。 | （A \| \| B）为真 |
| !      | 称为逻辑非运算符，用来反转操作数的逻辑状态。如果条件为true，则逻辑非运算符将得到false。 | ！（A && B）为真  |



> 短路与不短路有啥区别？

- 短路时，若第一个操作数已经能够决定表达式的值了，后面就都不算了

- 计算结果不变，但是执行效率变高了
- 有些书籍里，不把&和 |列入逻辑运算符中，而是直接称之为位运算符
- 实际开发，&&、||、！最常用



---



## 5. 位运算符（shift，了解）

> 什么是位运算符？

- 确切的说，应该叫”移位运算符“

- 位运算符是直接对整数的二进制位进行计算的运算符
- 移位运算符、或、与、异或位运算符是二元运算符
- 按位取反位运算符是一元运算符



对于int a = 60;b=13有以下规则

| 操作符 | 描述                                                         | 例子                           |
| :----- | :----------------------------------------------------------- | :----------------------------- |
| ＆     | 如果相对应位都是1，则结果为1，否则为0                        | （a＆b），得到12，即0000 1100  |
| \|     | 如果相对应位都是0，则结果为0，否则为1                        | （a \| b）得到61，即 0011 1101 |
| ^      | 如果相对应位值相同，则结果为0，否则为1                       | （a ^ b）得到49，即 0011 0001  |
| 〜     | 按位取反运算符翻转操作数的每一位，即0变成1，1变成0。         | （〜a）得到-61，即1100 0011    |
| <<     | 按位左移运算符。左操作数按位左移右操作数指定的位数。在一定范围内，每左移一位，相当于乘以2 | a << 2得到240，即 1111 0000    |
| >>     | 按位右移运算符。左操作数按位右移右操作数指定的位数。在一定范围内，每右移一位，相当于除以2 | a >> 2得到15即 1111            |
| >>>    | 按位右移补零操作符。左操作数的值按右操作数指定的位数右移，移动得到的空位以零填充。 | A>>>2得到15即0000 1111         |

> 右移和左移的实质

- 左移就是把左边移出去的高位截断，在低位补数，无论原先的数是正是负，空位都补0
  - 在一定范围内，M << n 可以这么算  M << n = M \* 2^n
- 右移就是把右边移出去的低位截断，在高位补数，正数补0，负数补1
  - 在一定范围内，M >> n 可以这么算   M >> n  = M / 2^n，如果是整数很容易精度损失，丢失小数位





> 有符号移位和无符号移位的区别

- "<<"有符号左移的时候，情况比较简单，被移除的最高位丢弃，空缺位补0
- “>>”有符号右移的时候
  - 若是正数，最高位是0，被移除的低位丢弃，右移后最高位空缺位补0
  - 若是符号，最高位是1，被移除的地位丢弃，右移后最高位空缺位补1
- “>>>”无符号右移动的时候，无论是正数负数，最高位是0还是1，被移除的低位丢弃，右移后最高位空缺位补0



> &、| 、^（与、或、异或）位运算符

<img src="../../../课件附属图片/位运算1.png" alt="image-20210101080722228" style="zoom:50%;" />



> ~取反位运算符

![image-20210101131324752](F:\markdown_picture\image-20210101131324752.png)

把一个数取反一次，再取反一次，请问这个数变了吗？



> ^异或位运算符

<img src="../../../课件附属图片/位运算2.png" alt="image-20210101081138796" style="zoom:50%;" />



> 数学中，^表示次幂，但是^在Java中显然不是次幂，那么该怎么求一个数的次幂呢？

- Math.pow()
- Math是一个工具类，里面装的是有关数学的一些操作



> 经典操作

- 怎么算 2*16 最高效？



---



## 6. 三目运算符（ternary）

> 什么是三目运算符

- 三目运算符也被称之为三元运算符，指的是需要三个操作数的运算符

> 语法

```java
(条件表达式)?表达式1:表达式2
```

- 当条件表达式为true时，执行表达式1，否则执行表达式2

- 三目运算符最大的特点就是它一定会执行一个表达式，一定会有结果
- 语句不能放在表达式的位置，这极大的限制了三目运算符的使用



> 练习

- 获取两个整数中的最大值
- 获取三个整数中的最大值



> 注意

- 实际开发中，不要使用过于复杂的三目运算符，否则会导致程序可读性变差



---



## 7. 运算符的优先级

> 运算符的优先级决定了谁先进行运算，是既重要也不重要的知识点
>
> 重要在于，运算符的优先级对表达式结果有显著影响，不重要在于可以用（）主动控制优先级
>
> Java当中运算顺序

- 所有的数学运算都认为是是从左向右的，java语言中大部分运算符也是从左向右的结合的
- 只有单目运算符，赋值运算符，三目运算符例外
  - 其中单目运算符，赋值运算符合三目运算符是从右向左结合，也就是从右向左运算的
  - 三目运算符实际上是一种选择结构



> 运算符有不同的优先级，所谓优先级就是在表达式运算中的运算顺序
>
> 下表中列出了运算符的优先级顺序，编号越小的运算符优先级越大

| 编号 | 类别     | 操作符                                     | 计算顺序 |
| ---- | :------- | :----------------------------------------- | :------- |
| 0    | 后缀     | () [] . (点操作符)                         | 左到右   |
| 1    | 一元     | + + - ！〜                                 | 从右到左 |
| 2    | 乘性     | * /％                                      | 左到右   |
| 3    | 加性     | + -                                        | 左到右   |
| 4    | 移位     | >> >>>  <<                                 | 左到右   |
| 5    | 关系     | >> = << =                                  | 左到右   |
| 6    | 相等     | == !=                                      | 左到右   |
| 7    | 按位与   | ＆                                         | 左到右   |
| 8    | 按位异或 | ^                                          | 左到右   |
| 9    | 按位或   | \|                                         | 左到右   |
| 10   | 逻辑与   | &&                                         | 左到右   |
| 12   | 逻辑或   | \| \|                                      | 左到右   |
| 13   | 条件     | ？：                                       | 从右到左 |
| 14   | 赋值     | = + = - = * = / =％= >> = << =＆= ^ = \| = | 从右到左 |
| 15   | 逗号     | ，                                         | 左到右   |

- 优先级很长，记忆很痛苦，即便记住，忘记也很快
  - 实际上没有人会真的死记硬背优先级，必要时可以在表达式中使用小括号，小括号的优先级最高
- 不要写太长的表达式，你是在出面试题吗？
  - 过于复杂的表达式，分几步完成
  - 对于代码而言，可读性最重要
- **虽然我们无需具体记忆这些优先级，但是仍然需要记住—赋值运算符的优先级往往最低**


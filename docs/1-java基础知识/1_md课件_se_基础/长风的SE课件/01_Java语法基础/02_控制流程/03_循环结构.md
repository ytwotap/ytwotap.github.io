# ③循环结构（Loop Structure）

[TOC]

---



## 1. 引言

> 生活本身就是一个循环，我们需要每天重复做一些事情
>
> 引申到开发当中，也完全有这种重复做某种操作的需求
>
> Java种提供了特定的语法，来帮助我们实现重复做事情的需求

- 这就是循环结构，循环结构包括三种主要的实现方式：
  - for循环
  - while循环
  - do...while循环
- 其中，for循环是最基础，也是使用最多的循环



> 循环概述总体概述

- Java当中的循环结构，无论是for、while还是do...while，其结构都由四部分组成：

  - 初始化语句
  - 条件判断语句（布尔表达式）
  - 循环体语句
  - 循环控制语句
  - 除了四个结构组成部分，如果你希望循环能够终止，那么循环控制变量也是必须的

- 各自的作用：

  - 初始化语句，用于给循环控制变量初始化，最大特征是只会执行一次
  - 条件判断语句，根据循环控制变量写布尔表达式，判断循环的状态，结果只有两种，true或者false
    - 结果为true，循环继续，执行循环体语句
    - 结果为false，循环终止，退出循环
  - 循环体语句，循环结构要重复执行的代码
  - 循环控制语句，用于改变循环控制变量的值，进而改变循环的状态，使循环终止

  

## 2. for循环

> 概述：

- 语法：

```java
for(初始化语句 ; 条件判断语句(布尔表达式); 循环控制语句) {
  //循环体语句  
}
```

- for循环的执行顺序：
  - 执行初始化语句，初始化循环控制变量，该语句只会执行一次
  - 执行布尔表达式进行条件判断，如果结果是
    - true，继续执行
    - false，循环终止
  - 执行循环体语句
  - 执行循环控制语句，改变循环控制变量的值
  - 执行布尔表达式，开始循环
    - 直到布尔表达式的结果是false，循环终止



> 流程图：

<img src="../../../课件附属图片/for循环控制流程.jpg" alt="for循环控制流程" style="zoom: 33%;" />



> 注意事项：

- 条件判断语句的结果是一个布尔类型的值，习惯上使用i，j，k三个作为循环控制变量的变量名

- 循环体语句如果是一条语句，也可以省略大括号，和if一样，酌情考虑是否省略

- for循环内部定义的变量，包括初始化语句中的循环变量和循环体语句内部定义的变量

  - 都是局部变量，其作用范围仅在for循环内部

- 在for循环中，初始化语句，布尔表达式，循环控制语句都不是必须的，<font color="red">但两个分号是必须的</font>

  - 初始化语句省略后，循环控制变量仍要初始化，格式就变成

    - ```java
      初始化语句;
      for( ; 条件判断语句(布尔表达式); 循环控制语句) {
        //循环体语句  
      }
      ```

  - 条件判断语句省略后，循环就没有终止条件了，循环变成死循环

  - 循环控制语句省略后，循环虽然有终止条件，但是循环控制变量的值却不会发生变化了，仍然会死循环

    - 如果不想死循环，可以将循环控制语句，放在循环体语句中，如下

    - ```java
      for(初始化语句 ; 条件判断语句(布尔表达式); ) {
          循环控制语句;
        //循环体语句  
      }
      ```
  
- 可以看出，在for循环中，省略部分结构语句并不是什么高端的技术，如非必要，请使用标准格式for循环



> 小试牛刀

- 用for循环计算1+2+3+...+10
- 用for循环计算1+2+3+...+100
- 用for循环求出1-100之间偶数和
- 用for循环求5的阶乘
- 经典循环案例：求所有的水仙花数，并统计个数
  - 所谓的水仙花数是指一个三位数，其各位数字的立方和等于该数本身
  - 举例：153就是一个水仙花数，153 = 1 * 1 * 1 + 5 * 5 * 5 + 3 * 3 * 3 = 1 + 125 + 27 = 153 

​	

## 3. while循环

> 概述：

- 语法

```java
初始化语句;
while(条件判断语句){
  循环体语句;
  (循环控制语句)
}
```

- while循环的循环控制语句，往往和循环体语句放在一起
- while循环的语义、执行流程都和for循环一模一样，while和for是完全等价的



> 小试牛刀

- 珠峰的高度是8848m，假设有一张足够大可折叠的纸张，初始厚度是0.01m，
  - 求解这张纸折叠多少次，纸张的厚度开始超过珠峰？



> 得出结论：

- 标准格式的for循环，循环控制变量声明在for循环内部，而while则声明在外部
  - 如果需求是循环结束还要使用循环控制变量，就使用while循环
  - 实际上for循环也可以把循环控制变量声明在外部，所以这个区别也不是绝对的
- while循环与for循环，实际并无不同，完全可以互相转换，如果非要硬找不同
  - 在循环次数不够明确，循环范围不确定时，使用while循环逻辑上更明确
  - 如果循环次数很明确，范围已清楚，仍然建议使用for循环



## 4. do...while循环

> 概述：

- 语法

```java
初始化语句;
do{
    循环体语句;
    (循环控制语句)
} while(条件判断语句);
```

- 条件判断语句后面的分号不能省略，否则报错
- do...while循环的循环控制语句，往往和循环体语句放在一起
- do...while循环的语义、执行流程都和while循环类似，唯一不同的是
  - do...while中的循环体语句，在第一次执行的时候，不经过条件判断语句
  - do...while中的循环体语句，至少都要执行一次

> 流程图：



<img src="../../../课件附属图片/do...while循环结构图.png" alt="image-20210102064539686" style="zoom: 50%;" />



> 注意事项

- 由于哥哥们过于优秀，do...while作为小弟被使用的次数很少

- do...while实际使用场景

  ```java
  //火车票抢票软件的业务逻辑
  do{
  	//抢票
  }while(没抢到);
  ```





## 5. 三种循环结构的比较（compare）

> while、for和do...while

- while和for都要先判断条件是否成立，再决定是否执行循环体语句
- do...while先执行循环体语句，再执行判断条件。所以无论如何，do...while都要执行一次循环体语句
- while、for是先谈再干，do...while是干了再说

> while和for

- 局部变量，循环控制变量
- 循环次数

> 怎么选择

- 能抓到老鼠的就是好猫
- 实际开发中，优先考虑for循环，再选while，最后才是do...while





## 6. 死循环（endless loop）

> 死循环在大多数实际开发场景都是严重的错误，但是在测试环境死循环有时候能帮助我们测试

- 如无必要，不要写死循环，尤其是生产环境

> 如何写死循环？

- ```java
  for(;;){
  }
  ```
  
- ```java 
  while(true){
  }
  ```







## 7. 嵌套for循环（multi-for）

> 引例

- 打印四行六列的井号
  - 内层for列数
  - 外层for控制行数



> 概述：

- 所谓嵌套for循环，就是在for循环里嵌套一个for循环



> 总结：

- 嵌套for循环极大的增加了代码的可读难度，如果不是非常有必要，最好不要使用
- 即便是要使用，最好也不要超过两层



> 习题

- 打印以下图案

```
#
##
###
####
#####
```

- 打印九九乘法表


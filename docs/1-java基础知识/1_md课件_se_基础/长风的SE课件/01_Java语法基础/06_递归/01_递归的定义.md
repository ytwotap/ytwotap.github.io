# ①方法的递归（recursion）

[TOC]

---



## 1. 引例

> 从前有座山，山里有座庙，庙里有个老和尚和一个小和尚，老和尚给小和尚讲故事：
>
> ​	从前有座山，山里有座庙，庙里有个老和尚和一个小和尚，老和尚给小和尚讲故事：
>
> ​		从前有座山，山里有座庙，庙里有个老和尚和一个小和尚，老和尚给小和尚讲故事：
>
> ​			.....

- 这个故事有什么特点呢？
  - 在一个故事当中，再次提到了同样的故事
- 类似这种“**套娃**”的理念，其实就是递归的核心理念



> 当然递归不是下面的递“龟”！

<img src="../../../课件附属图片/递“龟”.png" alt="1610764816966" style="zoom: 33%;" />





## 2. 递归定义

> 回到Java语法当中，方法是可以调用方法的。
>
> ​	实际上，我们总是在main方法（程序入口方法）中调用其它方法，才能够去使用该方法

- 特别的，在一个方法当中再次调用这个方法，就像故事里提到同样的故事一样
- 我们把方法在运行时调用自身的情况，称之为递归，又叫做递归调用





## 3. 使用递归注意事项

> 递归的使用有很多限制，尤其要注意以下两点

1. 合法的递归，除了要有递归体语句外，还要有递归出口
   - 不能无限制的递归下去，否则会发生栈溢出错误（StackOverflowError）
2. 即便是有出口的递归，递归的深度也不能超过栈空间的大小，否则仍然会报错





## 4. 递归栈溢出错误

> 递归是方法自我调用的过程，但是“只递不归”的”套娃“会导致程序崩溃，报错“StackOverflowError”
>
> 递归栈溢出错误（StackOverflowError）
>
> ​	是一个错误（Error）级别的异常，是比Exception要更加的严重的错误

- 产生栈溢出错误的原因在于：
  1. Java程序运行时，调用方法是有代价的：要占用栈（stack）中的内存空间
  2. 方法执行结束后，方法出栈，释放内存，所以一般情况下，栈内存不会溢出，始终够用
  3. 无限制的递归调用方法，会导致方法只进栈不出栈，很快栈内存空间就不够用了
  4. 这种情况就是“栈溢出错误”，对程序而言是致命错误，程序必须停止执行



>  热知识：StackOverflow.com 是全球最大的程序员问答平台



## 5. 递归的思想与危险的递归

> 引例：
>
> ​	使用递归计算N（N>=1）的阶乘

- 递归的两要素
  - 递归体（方法中自身调用自身方法的那句语句）
  - 递归出口
- 递归的思想
  1. 把一个复杂的大规模的问题，分解成若干相似的小规模的子问题
  2. 当子问题规模足够小的时候，就可以直接得到小规模问题的解
  3. 然后把所有的小规模的子问题的解，组合起来
  4. 最终得到大规模问题的解

- 递归的优缺点
  - 优点
    - 递归的代码会非常简洁
    - 人在解决问题时都会下意识的分解问题，递归的思想很符合人的思维，递归的思路容易理解‘
  - 缺点
    - 不用递归时，往往一个方法就能解决问题。
      - 显然递归调用多个方法，占用大量栈内存，且效率非常低
    - 递归分解小问题时，完全可能存在重复计算
    - 栈溢出错误警告！递归很危险，一旦栈溢出是严重错误！
  - 递归的缺点是很大的，如非必要，不要使用递归，尤其是开发中！



## 6. 补充（了解）

- 为了测试某个方法的递归深度，可以采用以下方法

```java
public static int sum(int a) {
        //int b = 1000;
        try {
            return a + sum(a - 1);
        } catch (StackOverflowError error) {
            System.out.println("sum方法" + a + "层");
        }
        return 0;
 	}
```

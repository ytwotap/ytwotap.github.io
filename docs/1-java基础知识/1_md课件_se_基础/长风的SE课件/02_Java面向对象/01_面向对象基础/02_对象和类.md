# ②对象和类

[TOC]

## 1. 引例

> 程序的世界就是对现实生活的模拟，把现实生活中的场景搬到程序中

- 淘宝京东的体系是怎么组成的？
  - 是对现实世界交易的模拟，由以下两部分组成
  - 由客观存在的个体（卖家，买家，商品，仓库，快递员等等）组成
  - 个体之间发生联系，从而完成不同的业务（交易，快递，收付款等）

- 整个现实世界，也是由这两部分组成的
  - 每个独立的个体，相互协作，保证了世界的正常运转

- 类比于客观世界，Java程序世界也是由两个部分组成：
  - 运行的程序，也是由很多个独立的个体组成
  - 个体之间产生正确的联系，从而实现程序的功能
    - 思考这些独立的个体都是什么呢？

- 这些独立的个体在Java程序的世界里，就是对象
  - 我们Java程序员的工作就是创建一个个的对象，然后管理对象之间关系
  - 让这些对象之间相互协作，共同实现程序的功能
  - 我们程序员就是Java程序世界中的“上帝，资本家”

> 我们迫切的希望创建对象来完成程序，在这之前我们还需要知道用什么来创建对象

- 上帝创造人的时候，是以自己的模样为模板，而Java呢？
  - 我们并不能直接跳到程序中去创建对象
  - 必须依赖JVM帮助我们创建
  - 于是我们必须告诉JVM——如何创建对象呢？
  - 这就是对象的模板——类

- 类这种模板如何描述对象呢？

> 类比上帝创造人，上帝是怎么描述人这个“新物种”呢？

- 第一，抽取出共性的“外貌特征”
- 第二，找到共同的“行为特征”
- 也就是说，外貌特征和行为特征组成了人类的基本样貌

- Java对象的模板——类也是这么描述对象的
  - **属性**（外貌特征）
  - **行为**（能力特征，能做什么）
  - 得出类的定义
    - 类就是对象的模板
    - 类抽取了同种类型的所有对象属性和行为上的共性
    - 一个类可以描述千千万万个对象

> 我们简单总结一下，面向对象就是在模仿我们的现实世界

- 类比客观世界的组成：对象是运行中的Java面向对象程序的基本组成单位，类比客观世界中的个体
- 类比客观世界个体的描述：对象的属性和行为
- 类比客观世界的个体的全体描述（模板）：抽取对象的共性特征形成类
- 类抽取出了同种类型的千千万万个对象的属性和行为上的共性(共同特征) ，类就是对象的模板
- 类和对象的关系
  - 类描述了，同种类型的对象，在属性和行为上的共同特征
  - 但是，类只规定了，有什么样的属性，有什么样的行为，但是，对象属性的取值，是由对象自己决定。一个类可以有千千万万不同的对象
- 对象与对象的关系
  - 不同类生成的对象，属性和行为往往都具有差异，不是同种对象
  - 相同类生成的对象，属性和行为具有相似性，但是也完全可能不同



## 2. 类的定义

> 定义类包括定义类结构本身，和定义类中属性和行为

### 2.1 定义一个类

> 类抽取出对象的共性的行为和共有的属性

- 类的定义我们并不陌生
- 语法

```java
[各种修饰符] class 类名{

}
```

- 一个Java文件中只能定义一个public修饰的类，但是可以定义多个非public类

### 2.2 定义类的成员

> 类中用成员变量来描述对象共有的属性
> 类中用成员方法来描述对象共性的行为

- **成员变量和成员方法合起来统称为（类的）成员**

- 局部位置：方法或者一些代码块结构当中属于局部位置
- 成员位置：类体种方法等局部位置外的其他位置

> 练习

```
定义学生类
    分析学生类中的属性和行为，根据学生类的属性和行为来定义学生类。
创建学生类对象，给属性赋值，并调用成员方法
```

1. 成员变量来表示属性

   - 成员变量：定义在成员位置的变量，而不是方法或局部位置的局部变量
   - 语法

   ```Java
   [访问权限修饰符] 数据类型 成员变量名;
   ```

2. 成员方法来表示行为

   - 成员方法：方法都定义在成员位置，表示对象行为的成员方法不能加static
   - 语法

   ```Java
   [访问权限修饰符] 返回值类型 方法名(){
       
   }
   ```

3. 创建类的对象

   - 在方法和能够写语句的地方创建对象然后使用该对象，可以认为是初始化一个引用数据类型的过程
   - 语法

   ```Java
   类名 对象名 = new 类名();
   ```

   - 对象名作为一个标识符字符串，遵循变量名的命名规范，小驼峰式的书写方式

4. 使用对象获取对象的属性和行为

   - 访问属性

   ```Java
   对象名.成员变量;
   ```

   - 调用行为（方法）

   ```java
   对象名.成员方法;
   ```

5. 直接输出对象名

   - 直接打印对象名得到的是类的全限定类名 + 十六进制的地址值

> 注意事项

- **类可以嵌套定义叫做内部类**，但是现在不要这么做，一个Java文件中定义多个class应该并列而不是包含
- 一个Java文件中的多个class是同包（文件夹）关系
- 一个类当中，应该开门见山的定义成员变量，而后再写成员方法
- 类中没有的属性和行为，对象是不可能有的，类是模板，模板中有才能创建出来 
- 使用new关键字就会创建新的对象，两条new语句创建的对象是完全独立的

---



## 3. 引用数据类型的全新理解

> 我们通过数组内存图引入了引用数据的概念
>
> 现在我们已经知道了，引用数据类类型是由栈上的引用和堆上的对象两部分组成

- 现在请回忆一下，基础语法部分数据类型的概念
- 思考：
  - 能否用数据类型的概念来统一基本数据类型和引用数据类型呢？

### 3.1 数据类型的概念

- 数据类型的概念

  - 一个数据集合和基于这个数据集合的一组操作，比如int，有固定的取值范围，有固定的操作
- 类的定义中，类包括：

  - 成员变量和成员方法
  - 做一下类比，得到：
    - 数据集合： 类中成员变量的集合
    - 操作集合： 类中成员方法的集合
- 总结

  - 一个类的定义，实际上就是定义了一种全新的数据类型，是一种自定义的数据类型
  - 这种数据类型，和基本数据类型不同，它是我们自己自定义的数据类型（引用数据类型）

### 3.2 引用数据类型的不同点

> 我们在使用一个基本数据类型时，由于基本数据类型是Java当中已经定义好的
>
> 所以JVM能够正常帮助我们开辟空间，正常给变量赋值

- 那么请思考我们自定义的引用数据类型开辟空间和赋值等过程，JVM也是直接完成的吗？
- 显然不是，自定义引用数据类型在一开始并不被JVM认识，所以首先JVM要认识该类型
- **这个认识引用数据类型的过程，称之为类加载**

> 显然

- 类加载要在创建对象之前，也就是说创建一个类的对象触发该类的类加载

- 类加载需要把一个类的class（字节码）文件读取到方法区内存中，然后经过一系列操作完成类加载

  - 类加载完毕后，JVM已经获取了该类的类型信息（有什么成员变量，方法等），能够完成创建对象

- 类和对象的关系，就可以类比于基本数据类型和基本数据类型变量之间的关系

  ```Java
  int a = 1; 
  //类比
  Student s = new Student();
  ```
  
- 在Student s = new Student()中

  - s是对象名或者称之为引用，我们通过引用访问这个s对象
  - new Student()是指示JVM帮助我们创建引用类型Student的对象

### 3.3 对象内存图练习

>  趁热打铁，为了大家更好的理解对象和类的关系，我们画一下内存图

```
练习：	
	1个对象的内存图，一个对象的基本初始化过程
	3个对象的内存图，其中有两个引用指向同一个对象
```
